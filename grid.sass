=row($margin: 0%, $gutter: 0%)
  display : inline-block

  //The calculations below contextually translate inputs for the end user
  //Page context is what a user would see
  //Row context is where the math is most convenient
  //Trimmed row context is what the CSS understands.
  $margin_page : min($margin - $gutter / 2, 0)
  $padding_page : $margin - $gutter / 2
  $width_page : 100% - $margin_page
  $page_to_row : 100% / $width_page
  $padding_row : $padding_page * $page_to_row
  $width_row : $width_page * $page_to_row - 2 * $padding_row
  $trimmed_page : $width_row / $page_to_row

  margin:
    left : $margin_page
  width : $trimmed_page
  padding:
    left : $padding_row
    right : $padding_row

=column($number_columns: 1, $columns_wide: 1, $margin: 0%, $gutter: 0%, $push_columns_left: 0, $push_columns_right: 0)
  display : block

  $margin_page : min($margin - $gutter / 2, 0)
  $padding_page : $margin - $gutter / 2
  $width_page : 100% - $margin_page
  $page_to_row : 100% / $width_page
  $padding_row : $padding_page * $page_to_row
  $width_row : $width_page * $page_to_row - 2 * $padding_row
  $trimmed_page : $width_row / $page_to_row

  $page_to_trimmed : 100% / $trimmed_page

  $margin_trimmed : $gutter / 2 * $page_to_trimmed

  $added_columns : $number_columns - 1
  $column_width_page : (100% - 2 * $margin - $added_columns * $gutter) / ($added_columns + 1)
  $multiple_column_page : $columns_wide * $column_width_page + ($columns_wide - 1) * $gutter
  $column_width_trimmed : $multiple_column_page * $page_to_trimmed

  $left_pushed_trimmed : $push_columns_left * ($column_width_trimmed + 2 * $margin_trimmed) + $margin_trimmed

  $right_pushed_trimmed : $push_columns_right * ($column_width_trimmed + 2 * $margin_trimmed) + $margin_trimmed

  margin:
    left : $left_pushed_trimmed
    right : $right_pushed_trimmed
  width : $column_width_trimmed

%box
  -webkit-box-sizing : border-box
  -moz-box-sizing : border-box
  box-sizing : border-box

%float_left
  float: left

%float_right
  float: right

//Layout for page, with pleasing margin and gutters
$margin: 10%
$gutter: 5%

body
  margin: 0
  width: 100%

.writeup
  +row($margin, $gutter)
  background-color: white
.discussion
  +column(1, 1, $margin, $gutter)
  @extend %float_left

code.mixin
  +column(1, 1, $margin, $gutter)
  @extend %float_left

code.example
  +column(2, 1, $margin, $gutter)
  @extend %float_left
  margin-bottom: 1em

//Example 1 - 2 column layout, no margins or gutters
.ex1_row
  +row()
  background-color: orange
.ex1_col
  +column(2, 1)
  @extend %float_left
  background-color: grey
  &:nth-of-type(2n)
    background-color: tan

//Example 2 - Three column layout, 5% margin, 10% gutter, with an additional element in the row.
.ex2_row
  +row(5%, 10%)
  background-color: yellow
.ex2_col
  +column(3, 1, 5%, 10%)
  @extend %float_left
  background-color: grey
  &:nth-of-type(2n)
    background-color: tan

.ex2-1_row
  +row(5%, 10%)
  background-color: yellow
  h1
    +column(1, 1, 5%, 10%)

//Example 3 - Four column layout with three column layout nested elements.
.ex3_row
  +row(8%, 4%)
  background-color: green
.ex3_col
  +column(4, 1, 8%, 4%)
  @extend %float_left
  background-color: grey
  &:nth-of-type(2n)
    background-color: tan
h1
  +column(1, 1, 0%, 0%)
  @extend %float_left
.ex3_nest_row
  +row(10%, 5%)
.ex3_nest
  +column(3, 1, 10%, 5%)
  @extend %float_left
  color: red
  background-color: grey
  &:nth-of-type(2n)
    background-color: black

